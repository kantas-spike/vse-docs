

<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>2.2.4.1. Volume level &mdash; Blender VSE Unofficial Documentation  ドキュメント</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme_overrides.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://kantas-spike.github.io/vse-docs/video_editing/edit/sound/measuring/volume.html" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script src="../../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="索引" href="../../../../genindex.html" />
    <link rel="search" title="検索" href="../../../../search.html" />
    <link rel="next" title="2.2.4.2. Audacity" href="../audacity/audacity.html" />
    <link rel="prev" title="2.2.4. サウンドの編集" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Blender VSE Unofficial Documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../video_sequencer/index.html">1. Video Sequence Editor</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">2. Video Editing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../setup/index.html">2.1. セットアップ</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">2.2. プロジェクトを編集する</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../montage/index.html">2.2.1. Montage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../effects/index.html">2.2.2. Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../color-grading/index.html">2.2.3. Color grading</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">2.2.4. サウンドの編集</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">2.2.4.1. Volume level</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#volume-level-value-loudness">2.2.4.1.1. Volume level value と loudness(音量) の関係</a></li>
<li class="toctree-l5"><a class="reference internal" href="#blender-python-db">2.2.4.1.2. Blender Python で dB 値を計算するにはどうすればよいですか?</a><ul>
<li class="toctree-l6"><a class="reference internal" href="#db">2.2.4.1.2.1. ストリップ全体のdB値</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id1">2.2.4.1.2.2. 現在のフレームまたはストリップのセクションの dB 値</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id2">2.2.4.1.2.3. トリミングされたストリップのデシベル値</a></li>
<li class="toctree-l6"><a class="reference internal" href="#id3">2.2.4.1.2.4. アニメーションストリップのデシベル値</a></li>
<li class="toctree-l6"><a class="reference internal" href="#some-useful-url">2.2.4.1.2.5. Some useful URL</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../audacity/audacity.html">2.2.4.2. Audacity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../render/index.html">2.3. Render your project</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../extra-tools/index.html">3. 追加ツール</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Blender VSE Unofficial Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html"><span class="section-number">2. </span>Video Editing</a> &raquo;</li>
        
          <li><a href="../../index.html"><span class="section-number">2.2. </span>プロジェクトを編集する</a> &raquo;</li>
        
          <li><a href="../index.html"><span class="section-number">2.2.4. </span>サウンドの編集</a> &raquo;</li>
        
      <li><span class="section-number">2.2.4.1. </span>Volume level</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/video_editing/edit/sound/measuring/volume.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="volume-level">
<h1><span class="section-number">2.2.4.1. </span>Volume level<a class="headerlink" href="#volume-level" title="この見出しへのパーマリンク">¶</a></h1>
<p>オーディオを扱うすべてのプログラムには、何らかのボリューム スライダーがあります。
そして、それらはそれぞれ異なる意味を持っています！
Blender では、サウンド ストリップのプロパティとして見つけることができます。
これは 0 ～ 100 の数値です。値 &gt; 1 はサウンドを増幅します。値が 1 未満の場合、サウンド レベルが減少します。
シンプルですね。しかし、音量レベル 0.5 はどれくらい大きいのでしょうか? 1.0の半分くらいの音量でしょうか？最大値の 100 はどうでしょうか?本当に？100？</p>
<div class="section" id="volume-level-value-loudness">
<h2><span class="section-number">2.2.4.1.1. </span>Volume level value と loudness(音量) の関係<a class="headerlink" href="#volume-level-value-loudness" title="この見出しへのパーマリンク">¶</a></h2>
<p>次の式を使用して、ゲインまたは損失をデシベル (dB) 単位で計算できます。</p>
<ul class="simple">
<li><p>dB = 20 x log (volume level)</p></li>
<li><p>volume level = antilog (dB/20)</p></li>
</ul>
<p>したがって、ボリューム レベルを 0.5 に下げると、-6 dB の損失が生じます。音量レベルを 100 に上げると、20 x log(100) = 40 db のゲインになります。電卓の逆対数関数 (10&lt;sup&gt;x&lt;/sup&gt;) を使用すると、antilog(-6dB/20) = 0.5012 という逆計算を行うことができます。</p>
<table class="colwidths-given docutils align-default" id="id4">
<caption><span class="caption-text">デシベルと音量レベルの関係</span><a class="headerlink" href="#id4" title="このテーブルへのパーマリンク">¶</a></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>db loss/gain</p></th>
<th class="head"><p>-40</p></th>
<th class="head"><p>-30</p></th>
<th class="head"><p>-20</p></th>
<th class="head"><p>-10</p></th>
<th class="head"><p>-6</p></th>
<th class="head"><p>0</p></th>
<th class="head"><p>+6</p></th>
<th class="head"><p>+10</p></th>
<th class="head"><p>+20</p></th>
<th class="head"><p>+30</p></th>
<th class="head"><p>+40&quot;</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Volume Level</p></td>
<td><p>0.01</p></td>
<td><p>0.0316</p></td>
<td><p>0.1</p></td>
<td><p>0.316</p></td>
<td><p>0.501</p></td>
<td><p>1</p></td>
<td><p>1.995</p></td>
<td><p>3.162</p></td>
<td><p>10</p></td>
<td><p>31.62</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<p>心理学の研究によると、知覚される音量は 10 dB ごとに 2 倍になります。したがって、サウンドを 2 倍大きくするには、音量レベルを antilog(+10dB/20) = 3.16 に設定する必要があります。知覚される音を半分に減らすには、音量レベルをantilog(-10dB/20) = 0.316まで下げる必要があります。</p>
<p>デシベルは線形ではなく対数スケールであることに注意してください。これが、ボリューム スライダーが 0 ～ 1 ではなく非対称 (0 ～ 100) になっている理由です。スライダーを +100 に設定すると、音量が 40 dB 増加します。同じ量で音量を下げるには、音量を 0.01 に設定する必要があります。便利な変換表が <a class="reference external" href="https://en.wikipedia.org/wiki/Decibel">Wikipedia</a> にあります。</p>
<p>音がデジタル化されると、アナログ音波が離散的な瞬間にサンプリングされ、波の振幅 (音量) が保存されます。次の 2 つの概念が非常に重要です。</p>
<ul class="simple">
<li><p>サンプル レート: 一般的なサンプル レートは 44.100 Hz (オーディオ CD 品質)、つまり 1 秒あたり 44100 個のサンプルが取得されることを意味します。サンプルが多いほど品質は向上しますが、必要なストレージも増えます。</p></li>
<li><p>ビット深度: 各サンプルで、アナログ音波の振幅が電圧に変換され、数値 (通常は 16 ビットまたは 24 ビットの整数) で保存されます。 16 ビット整数には 2&lt;sup&gt;16&lt;/sup&gt; = 65536 個の値しかないため、表現できる最大振幅が存在します。これらの数値は、-1 から +1 までの浮動小数点数に変換されます。これらのしきい値 (-1 または +1) を超える振幅は、-1 または +1 でクリップされ、歪みが生じます。</p></li>
</ul>
<p>音の音量や大きさは、知覚的/心理的現象です。そのため、音の大きさは多くの要因によって影響されます。音波の振幅だけでなく、周波数（低音にはより多くのパワーが必要です）、環境（音源までの距離など）、リスナーの慣れなどです。以下の議論を簡単にするために、ラウドネス (心理的現象) を音波の振幅または電圧 (物理的現象) に換算します。</p>
<p>dbという尺度は相対的な尺度です。それはあるサウンドと基準サウンドとの比です。
デジタル サウンドの場合、基準は +1V の振幅、または選択したビット深度で保存できる最大振幅のサウンドです。この定義( <code class="docutils literal notranslate"><span class="pre">dB</span> <span class="pre">=</span> <span class="pre">log(sample</span> <span class="pre">voltage/1</span> <span class="pre">V)</span> <span class="pre">``</span> <span class="pre">)のため</span> <span class="pre">、サンプル電圧</span> <span class="pre">=</span> <span class="pre">1V</span> <span class="pre">の</span> <span class="pre">dB</span> <span class="pre">値はゼロです。</span> <span class="pre">``log(1/1)</span> <span class="pre">=</span> <span class="pre">0</span></code> であるためです。
したがって、ゼロ dB は、何もせずに得られる最大音響レベルです。サウンドレベルを下げるとマイナスのdBになります。</p>
</div>
<div class="section" id="blender-python-db">
<h2><span class="section-number">2.2.4.1.2. </span>Blender Python で dB 値を計算するにはどうすればよいですか?<a class="headerlink" href="#blender-python-db" title="この見出しへのパーマリンク">¶</a></h2>
<p>添付のブレンド ファイルには、サウンド ストリップの dB 値とその他のサウンド パラメータを計算する Python スクリプトが含まれています。コードは <a class="reference external" href="https://github.com/snuq/VSEQF">Snuq's VSEQF-addon</a> (vu_meter.py) に基づいています。
例として、Blender のオープン ムービー <a class="reference external" href="https://www.youtube.com/watch?v=WhWc3b3KhnY">Spring</a> を使用します。</p>
<p>まず、選択したオーディオ ストリップとそれに含まれるサウンド データへのハンドルが必要です。ストリップのプロパティ (ボリュームなど) はアニメーション化できるため、現在のシーンおよびビュー レイヤの依存関係グラフで継続的に更新されるアニメーション化されたデータ ブロックにアクセスする必要があります。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">bpy</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">strip</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">sequence_editor</span><span class="o">.</span><span class="n">active_strip</span>
<span class="n">depsgraph</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">evaluated_depsgraph_get</span><span class="p">()</span>
<span class="n">sound</span> <span class="o">=</span> <span class="n">strip</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">evaluated_get</span><span class="p">(</span><span class="n">depsgraph</span><span class="p">)</span><span class="o">.</span><span class="n">factory</span>
</pre></div>
</div>
<div class="section" id="db">
<h3><span class="section-number">2.2.4.1.2.1. </span>ストリップ全体のdB値<a class="headerlink" href="#db" title="この見出しへのパーマリンク">¶</a></h3>
<p>対策はかなりあります。最もよく使用されるのは次のとおりです。</p>
<ul class="simple">
<li><p>ピーク値: ストリップ内の最高/最低 dB 値。これはボリュームメーター(VUメーター)で表示されるものです。</p></li>
<li><p>RMS (二乗平均平方根): ストリップ全体の平均 dB。</p></li>
</ul>
<p>まず、サンプリングされたデータにアクセスする必要があります。これは 2 次元の numpy float 配列です。最初の次元はサンプル数です。 2 番目はチャンネル数です (モノラルの場合は 1、ステレオの場合は 2)。値は 0 ～ 1 の浮動小数点数です。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">min</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

<span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">min</span><span class="p">):</span>
   <span class="n">peak</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
   <span class="n">peak</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">min</span><span class="p">)</span>

<span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span>
</pre></div>
</div>
<p>Sound オブジェクトの data() メソッドは、ストリップがトリミングされ、ボリューム レベルが適用されていない場合でも、ストリップ全体のサンプリングされたデータを返します。言い換えれば、これらはサンプリングされた生のデータです。ただし、サウンドのピーク値は、サウンドの大きさの適切な推定値ではない場合があります。ある種の平均値が必要です。音波には正と負のサンプル値が含まれているため、単純な平均ではほぼゼロレベルに打ち消されます。 RMS 値が解決策です。各サンプル値は 2 乗され (負の数が削除され)、これらの 2 乗の平均 (平均) が計算され、平方根で元のレベルに再び減らされます。</p>
<p>サンプリングされたデータは numpy 配列に含まれているため、コードは比較的単純です。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">rms</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">rms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3><span class="section-number">2.2.4.1.2.2. </span>現在のフレームまたはストリップのセクションの dB 値<a class="headerlink" href="#id1" title="この見出しへのパーマリンク">¶</a></h3>
<p>タイムラインのPlayhead/カーソルの下にあるサウンド サンプルの dB 値が必要だとします。ただし、オーディオ ストリップはフレームではなくタイムコードで機能します。これが多くの誤解の原因となっています。たとえば、MP4 ファイル (ビデオ + オーディオ) があり、シーンのフレーム/秒パラメータを変更すると、ビデオの長さは変わりますが、オーディオ ストリップの長さは変わりません。オーディオ ストリップの長さは、サンプル レートとサンプル数に基づいて計算できます。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">sample_rate</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">specs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">nr_of_samples</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">length</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">nr_of_samples</span><span class="o">/</span><span class="n">sample_rate</span>
</pre></div>
</div>
<p>sound.length が len(sound.data()) に等しいと期待するかもしれませんが、どうやらそうではありません。オープン ムービー スプリングの場合: sound.length = 20466685 および len(sound.data() = 20466688)。</p>
<p>サンプル数はフレームよりもはるかに多いため、各フレームのサウンド データには複数のサンプルが含まれます。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">nr_of_frames</span> <span class="o">=</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_final_end</span>
<span class="n">nr_of_samples_per_frame</span> <span class="o">=</span> <span class="n">nr_of_samples</span><span class="o">/</span><span class="n">nr_of_frames</span>
</pre></div>
</div>
<p>公開中のムービー &quot;Spring&quot; の場合: duration = 464.1s、nr_of_frames = 11139、nr_of_sample_per_frame = 1837.38 です。
したがって、各フレームには 1837 個のサンプルがあります。
Playhead の下の dB 値を計算するには、これらの 1837 サンプルのピーク値または rms 値が必要です。</p>
<p>これらのサンプルには、limit メソッドを使用してアクセスできます。この方法はタイムコードで機能します。したがって、現在のフレームの開始タイムコードと終了タイムコードが必要になります。これらの開始時間と終了時間は、選択したストリップを基準としています。選択したストリップの最初のフレームはゼロです。ただし、現在のフレームはタイムラインを基準としています。したがって、現在のフレームからstrip.frame_startを減算する必要があります。 db または RMS 値の計算は上記と同じです。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">cur_frame</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">frame_current</span>
<span class="n">fps</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">fps</span> <span class="o">/</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">fps_base</span>
<span class="n">time_from</span> <span class="o">=</span> <span class="p">(</span><span class="n">cur_frame</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">fps</span>
<span class="n">time_to</span> <span class="o">=</span> <span class="p">(</span><span class="n">cur_frame</span> <span class="o">-</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span><span class="p">)</span> <span class="o">/</span> <span class="n">fps</span>
<span class="n">sound_cur_frame</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">time_from</span><span class="p">,</span> <span class="n">time_to</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3><span class="section-number">2.2.4.1.2.3. </span>トリミングされたストリップのデシベル値<a class="headerlink" href="#id2" title="この見出しへのパーマリンク">¶</a></h3>
<p>Sound オブジェクトの Data メソッドは常にストリップ全体のすべてのサンプルを返すため、トリミングされたストリップに対しては、limit メソッド (上記のセクション 2.2 を参照) も使用する必要があります。ストリップの [トリミングとカット](../video/trimming.md) については、別の投稿で詳しく説明します。図 3 は、さまざまなアンカー ポイントをまとめたものです。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">time_from</span> <span class="o">=</span> <span class="p">(</span><span class="n">strip</span><span class="o">.</span><span class="n">frame_final_start</span> <span class="o">-</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span><span class="p">)</span><span class="o">/</span><span class="n">fps</span>
<span class="n">time_to</span> <span class="o">=</span> <span class="p">(</span><span class="n">strip</span><span class="o">.</span><span class="n">frame_final_end</span> <span class="o">-</span>  <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span><span class="p">)</span><span class="o">/</span><span class="n">fps</span>
<span class="n">sound_trimmed_strip</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">time_from</span><span class="p">,</span> <span class="n">time_to</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3><span class="section-number">2.2.4.1.2.4. </span>アニメーションストリップのデシベル値<a class="headerlink" href="#id3" title="この見出しへのパーマリンク">¶</a></h3>
<p>サウンド データには、生のサンプリング データが含まれています。ストリップ全体のボリューム レベルの変更を考慮するには、このレベルと生データを単純に乗算します。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">max</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">data</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">strip</span><span class="o">.</span><span class="n">volume</span>
</pre></div>
</div>
<p>ただし、ストリップのボリューム レベルは、フレームごとに変更したりアニメーション化したりできます。セクション 2.2 では、1 フレームの dB 値を計算しました。依存関係グラフのおかげで、strip.volume 値がその特定のフレームに対して更新されるため、この値を使用できます。したがって、アニメーション ストリップ全体の dB 値を計算するには、ストリップをフレームごとにループし、Playheadをそのフレームに設定し、そのフレームの sound.data を取得するのが最も簡単です (ただし、最も効率的ではないかもしれません)。 、それに音量を乗算し、これらのデータを配列に累積します。</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_rms</span><span class="p">(</span><span class="n">samples</span><span class="p">):</span>
   <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">samples</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">rms</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
   <span class="k">return</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">rms</span><span class="p">)</span>

<span class="n">animated_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="n">strip</span><span class="o">.</span><span class="n">frame_final_start</span><span class="p">,</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_final_end</span><span class="p">):</span>
   <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">frame_set</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

   <span class="n">time_from</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">fps</span>
   <span class="n">time_to</span>   <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">strip</span><span class="o">.</span><span class="n">frame_start</span><span class="p">)</span><span class="o">/</span><span class="n">fps</span>

   <span class="n">chunk</span> <span class="o">=</span> <span class="n">sound</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">time_from</span><span class="p">,</span> <span class="n">time_to</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
   <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span> <span class="o">*</span> <span class="n">strip</span><span class="o">.</span><span class="n">volume</span>


   <span class="n">animated_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">animated_samples</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frame &quot;</span><span class="p">,</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">frame_current</span><span class="p">,</span><span class="s2">&quot;time:&quot;</span><span class="p">,</span> <span class="n">time_from</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">time_to</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
     <span class="s2">&quot;size:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">),</span> <span class="s2">&quot;cum&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">animated_samples</span><span class="p">),</span>
     <span class="s2">&quot;RMS:&quot;</span><span class="p">,</span> <span class="n">get_rms</span><span class="p">(</span><span class="n">chunk</span><span class="p">),</span> <span class="s2">&quot;volume:&quot;</span> <span class="p">,</span><span class="n">strip</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
 <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total rms: &quot;</span><span class="p">,</span> <span class="n">get_rms</span><span class="p">(</span><span class="n">animated_samples</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="some-useful-url">
<h3><span class="section-number">2.2.4.1.2.5. </span>Some useful URL<a class="headerlink" href="#some-useful-url" title="この見出しへのパーマリンク">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sawvideo.com/index.php/news/2020/measuring-sound-levels-volume-and-loudness">https://www.sawvideo.com/index.php/news/2020/measuring-sound-levels-volume-and-loudness</a></p></li>
<li><p><a class="reference external" href="http://www.sengpielaudio.com/TableOfSoundPressureLevels.htm">http://www.sengpielaudio.com/TableOfSoundPressureLevels.htm</a></p></li>
<li><p><a class="reference external" href="http://www.sengpielaudio.com/calculator-soundlevel.htm">http://www.sengpielaudio.com/calculator-soundlevel.htm</a></p></li>
<li><p><a class="reference external" href="http://sengpielaudio.com/calculator-gainloss.htm">http://sengpielaudio.com/calculator-gainloss.htm</a></p></li>
<li><p><a class="reference external" href="http://www.sengpielaudio.com/calculator-loudness.htm">http://www.sengpielaudio.com/calculator-loudness.htm</a></p></li>
<li><p><a class="reference external" href="http://sengpielaudio.com/calculator-levelchange.htm">http://sengpielaudio.com/calculator-levelchange.htm</a></p></li>
<li><p><a class="reference external" href="https://archive.org/details/fundamentalsofhe00yost/mode/2up">https://archive.org/details/fundamentalsofhe00yost/mode/2up</a></p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../audacity/audacity.html" class="btn btn-neutral float-right" title="2.2.4.2. Audacity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../index.html" class="btn btn-neutral float-left" title="2.2.4. サウンドの編集" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright This page is licensed under a CC-BY-SA 4.0 Int. License.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>